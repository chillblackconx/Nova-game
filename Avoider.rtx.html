<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Avoider</title>
<style>
body{margin:0;background:#000;overflow:hidden;position:relative;}
canvas{display:block;margin:0 auto;background:#111;}
#restartBtn{
    position:absolute;
    top:10px;
    right:10px;
    padding:10px 20px;
    font-size:16px;
    background:#0ff;
    color:#000;
    border:none;
    border-radius:5px;
    cursor:pointer;
    display:none;
}
</style>
</head>
<body>
<canvas id="game" width="400" height="400"></canvas>
<button id="restartBtn">Restart</button>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const restartBtn=document.getElementById('restartBtn');

let player={x:200,y:350,r:15};
let keys={};
let obstacles=[];
let score=0;
let gameOver=false;

document.addEventListener('keydown',e=>keys[e.key]=true);
document.addEventListener('keyup',e=>keys[e.key]=false);

function spawnObstacle(){
  const x=Math.random()*380;
  obstacles.push({x:x,y:0,w:20,h:20});
}

function update(){
  if(gameOver)return;
  
  // Déplacement joueur
  if(keys['ArrowLeft'] && player.x-player.r>0) player.x-=5;
  if(keys['ArrowRight'] && player.x+player.r<canvas.width) player.x+=5;
  if(keys['ArrowUp'] && player.y-player.r>0) player.y-=5;
  if(keys['ArrowDown'] && player.y+player.r<canvas.height) player.y+=5;
  
  // Obstacles
  obstacles.forEach(o=>{
    o.y+=3;
    // collision
    if(player.x+player.r>o.x && player.x-player.r<o.x+o.w && player.y+player.r>o.y && player.y-player.r<o.y+o.h){
      gameOver=true;
      restartBtn.style.display='block';
    }
  });
  
  // Supprime obstacles sortis
  obstacles=obstacles.filter(o=>o.y<canvas.height);
  
  // Score
  score++;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  // Joueur
  ctx.fillStyle='cyan';
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.r,0,Math.PI*2);
  ctx.fill();
  
  // Obstacles
  ctx.fillStyle='red';
  obstacles.forEach(o=>ctx.fillRect(o.x,o.y,o.w,o.h));
  
  // Score
  ctx.fillStyle='#0ff';
  ctx.font='16px Arial';
  ctx.fillText('Score: '+score,10,20);
  
  if(gameOver){
    ctx.fillStyle='yellow';
    ctx.font='30px Arial';
    ctx.fillText('GAME OVER',100,200);
  }
}

function loop(){
  if(Math.random()<0.02) spawnObstacle(); // aléatoire
  update();
  draw();
  requestAnimationFrame(loop);
}

function restartGame(){
  player={x:200,y:350,r:15};
  obstacles=[];
  score=0;
  gameOver=false;
  restartBtn.style.display='none';
}

restartBtn.addEventListener('click',restartGame);

loop();
</script>
</body>
</html>
