<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Nova OS</title>
<style>
body, html {margin:0;padding:0;width:100%;height:100%;background:#000;font-family:sans-serif;overflow:hidden;}
#desktop {position:relative;width:100%;height:100%;background:#111;}
.window {position:absolute;background:#222;border:2px solid #0ff;border-radius:6px;color:#fff;resize:both;overflow:auto;min-width:150px;min-height:100px;}
.window-header {background:#000;padding:4px;cursor:move;text-align:center;font-weight:bold;}
#taskbar {position:absolute;bottom:0;width:100%;height:40px;background:#111;border-top:2px solid #0ff;display:flex;align-items:center;padding:0 10px;}
.taskbar-button {background:#0ff;color:#000;padding:5px 10px;margin-right:5px;border-radius:4px;cursor:pointer;}
#shop {position:absolute;top:50px;left:50px;width:300px;background:#111;border:2px solid #0ff;padding:10px;display:none;}
.shop-item {border:2px solid #0ff;margin:5px;padding:5px;cursor:pointer;}
.shop-item.disabled {opacity:0.4;pointer-events:none;}
</style>
</head>
<body>
<div id="desktop"></div>

<!-- Barre des tâches -->
<div id="taskbar">
  <div class="taskbar-button" onclick="toggleShop()">Neon Shop</div>
</div>

<!-- Shop -->
<div id="shop"></div>

<script>
const desktop = document.getElementById('desktop');
let windows = [];
let shopVisible = false;

// Shop Items
let shopItems = [
  {name:'Bouton',price:100,stock:10,rarity:'Vert'},
  {name:'Glisser',price:200,stock:5,rarity:'Bleu'},
  {name:'Animation',price:300,stock:3,rarity:'Violet'},
  {name:'Effet',price:500,stock:2,rarity:'Jaune'},
  {name:'Super Module',price:1000,stock:1,rarity:'Rouge'},
  {name:'Pro Widget',price:2000,stock:1,rarity:'Platinium'}
];

const rarityColors = {
  'Vert':'#2ecc71',
  'Bleu':'#3498db',
  'Violet':'#9b59b6',
  'Jaune':'#f1c40f',
  'Rouge':'#e74c3c',
  'Platinium':'linear-gradient(90deg,#000,#fff)'
};

function toggleShop(){
  shopVisible = !shopVisible;
  document.getElementById('shop').style.display = shopVisible?'block':'none';
  renderShop();
}

function renderShop(){
  const shop = document.getElementById('shop');
  shop.innerHTML='<h3>Neon Shop</h3>';
  shopItems.forEach((item,i)=>{
    const div = document.createElement('div');
    div.className='shop-item'+(item.stock<=0?' disabled':'');
    div.style.borderColor=rarityColors[item.rarity]||'#0ff';
    div.innerText=`${item.name} (${item.rarity}) - ${item.price} crédits - Stock: ${item.stock}`;
    div.onclick = ()=>buyFeature(i);
    shop.appendChild(div);
  });
}

function buyFeature(index){
  const item = shopItems[index];
  if(item.stock<=0) return;
  item.stock--;
  createApp(item.name);
  renderShop();
}

function createApp(name){
  const win = document.createElement('div');
  win.className='window';
  win.style.top=Math.random()*300+'px';
  win.style.left=Math.random()*300+'px';
  win.innerHTML = `<div class="window-header">${name}</div><div class="window-content">Contenu de ${name}</div>`;
  desktop.appendChild(win);
  makeDraggable(win);
  windows.push(win);
}

function makeDraggable(el){
  const header = el.querySelector('.window-header');
  let offsetX,offsetY,isDown=false;
  header.addEventListener('mousedown',e=>{
    isDown=true;
    offsetX=e.clientX-el.offsetLeft;
    offsetY=e.clientY-el.offsetTop;
  });
  document.addEventListener('mouseup',()=>isDown=false);
  document.addEventListener('mousemove',e=>{
    if(!isDown) return;
    el.style.left=(e.clientX-offsetX)+'px';
    el.style.top=(e.clientY-offsetY)+'px';
  });
}

renderShop();
</script>
</body>
</html>
