<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nova Game / Nova OS</title>
<style>
body,html{margin:0;padding:0;width:100%;height:100%;overflow:hidden;font-family:sans-serif;background:#000;color:#fff;}
#nova-desktop{position:relative;width:100vw;height:100vh;background:#111;display:flex;flex-wrap:wrap;padding:10px;}
.icon{width:100px;height:100px;margin:10px;background:#222;color:#0ff;display:flex;flex-direction:column;justify-content:center;align-items:center;cursor:pointer;border:2px solid #444;border-radius:10px;user-select:none;text-align:center;}
.nova-window{position:absolute;width:400px;height:300px;background:#111;border:2px solid #0ff;border-radius:8px;top:50px;left:50px;display:none;flex-direction:column;z-index:100;box-shadow:0 0 20px #0ff;}
.window-header{background:#0ff;color:#000;padding:5px;cursor:move;display:flex;justify-content:space-between;align-items:center;font-weight:bold;}
.window-content{flex:1;padding:10px;overflow:auto;background:#111;}
.shop-item{padding:5px;margin:5px 0;border:1px solid #0ff;cursor:pointer;display:flex;justify-content:space-between;border-radius:4px;}
.disabled{opacity:0.3;pointer-events:none;}
@keyframes proGradient{0%{border-color:#000;color:#000;}50%{border-color:#fff;color:#fff;}100%{border-color:#000;color:#000;}}
.pro{animation:proGradient 2s linear infinite;}
#nova-game-window{border:none;}
#nova-game-iframe{width:100%;height:100%;border:none;}
#taskbar{position:absolute;bottom:0;left:0;width:100%;height:40px;background:#111;display:flex;align-items:center;padding:0 10px;border-top:2px solid #0ff;}
.task-icon{width:30px;height:30px;margin-right:5px;background:#222;border-radius:5px;display:flex;justify-content:center;align-items:center;color:#0ff;cursor:pointer;}
</style>
</head>
<body>

<!-- Bureau Nova OS -->
<div id="nova-desktop">
  <div class="icon" onclick="openNovaWindow('nova-shop')">Neon Shop</div>
  <div class="icon" onclick="openNovaWindow('nova-files')">Fichiers</div>
  <div class="icon" onclick="openNovaWindow('nova-terminal')">Terminal</div>
</div>

<!-- Barre des tâches -->
<div id="taskbar"></div>

<!-- Fenêtres -->
<div class="nova-window" id="nova-shop">
  <div class="window-header">Neon Shop <span onclick="closeNovaWindow('nova-shop')">✖</span></div>
  <div class="window-content" id="nova-shop-content"></div>
</div>

<div class="nova-window" id="nova-files">
  <div class="window-header">Explorateur <span onclick="closeNovaWindow('nova-files')">✖</span></div>
  <div class="window-content" id="nova-files-content">Aucun fichier pour le moment...</div>
</div>

<div class="nova-window" id="nova-terminal">
  <div class="window-header">Terminal <span onclick="closeNovaWindow('nova-terminal')">✖</span></div>
  <div class="window-content">Bienvenue dans Nova OS Terminal !</div>
</div>

<!-- Fenêtre de jeu RTX plein écran -->
<div class="nova-window" id="nova-game-window">
  <div class="window-header">Jeu RTX <span onclick="closeNovaWindow('nova-game-window')">✖</span></div>
  <div class="window-content"><iframe id="nova-game-iframe"></iframe></div>
</div>

<script>
// === Détection automatique des jeux RTX ===
const rtxGames=[
  {name:"Egg Battle", file:"eggbattle.rtx.html"},
  {name:"Space Shottors", file:"space-shottors.rtx.html"},
  {name:"Avoider", file:"avoider.rtx.html"}
];

// Ajouter les icônes des jeux sur le bureau
const desktop=document.getElementById('nova-desktop');
rtxGames.forEach(g=>{
  const div=document.createElement('div');
  div.className='icon';
  div.innerText=g.name;
  div.onclick=()=>launchGame(g.file);
  desktop.appendChild(div);
});

// === Shop Neon ===
const novaShopItems=[
  {name:'Icônes de bureau', rarity:'Vert', price:10, stock:10},
  {name:'Barre des tâches', rarity:'Vert', price:15, stock:10},
  {name:'Fenêtres redimensionnables', rarity:'Vert', price:10, stock:10},
  {name:'Explorateur de fichiers', rarity:'Bleu', price:20, stock:5},
  {name:'Bloc-notes', rarity:'Bleu', price:10, stock:5},
  {name:'Animations Neon', rarity:'Violet', price:80, stock:2},
  {name:'Widgets spéciaux', rarity:'Rouge', price:150, stock:1},
  {name:'Module Pro', rarity:'Pro', price:300, stock: Math.random()<0.02?1:0},
  {name:'Module Platinium', rarity:'Platinium', price:500, stock: Math.random()<0.01?1:0}
];

function renderNovaShop(){
  const container=document.getElementById('nova-shop-content');
  container.innerHTML='';
  novaShopItems.forEach((item,i)=>{
    const div=document.createElement('div');
    div.className='shop-item';
    if(item.rarity==='Pro'||item.rarity==='Platinium') div.classList.add('pro');
    if(item.stock<=0) div.classList.add('disabled');
    div.innerText=`${item.name} (${item.rarity}) - ${item.price} crédits - Stock: ${item.stock}`;
    div.onclick=()=>buyNovaItem(i);
    container.appendChild(div);
  });
}

function buyNovaItem(i){
  const item=novaShopItems[i];
  if(item.stock<=0) return;
  item.stock--;
  alert(`Vous avez acheté : ${item.name}`);
  renderNovaShop();
}

// === Restock automatique toutes les 5 minutes ===
function restockNovaShop(){
  novaShopItems.forEach(item=>{
    if(item.rarity==='Pro'){
      item.stock = Math.random() < 0.05 ? 1 : 0; // 5% chance
    } else if(item.rarity==='Platinium'){
      item.stock = Math.random() < 0.02 ? 1 : 0; // 2% chance
    } else {
      item.stock = Math.max(item.stock, Math.floor(Math.random()*5+1));
    }
  });
  renderNovaShop();
  console.log('Shop restocké !');
}
setInterval(restockNovaShop, 300000);

// === Fenêtres ===
function openNovaWindow(id){ 
  const w=document.getElementById(id); 
  w.style.display='flex'; 
  makeNovaDraggable(w);
  if(id==='nova-game-window'){w.style.top='0px'; w.style.left='0px'; w.style.width='100vw'; w.style.height='100vh';}
}
function closeNovaWindow(id){ document.getElementById(id).style.display='none';}

// Drag & Drop pour toutes les fenêtres
function makeNovaDraggable(el){
  const header=el.querySelector('.window-header');
  let offsetX, offsetY, dragging=false;
  header.onmousedown=(e)=>{ dragging=true; offsetX=e.clientX-el.offsetLeft; offsetY=e.clientY-el.offsetTop; };
  document.onmousemove=(e)=>{ if(dragging){ el.style.left=(e.clientX-offsetX)+'px'; el.style.top=(e.clientY-offsetY)+'px'; }};
  document.onmouseup=()=>dragging=false;
}

// === Lancer un jeu RTX plein écran ===
function launchGame(file){
  const iframe=document.getElementById('nova-game-iframe');
  iframe.src=file;
  openNovaWindow('nova-game-window');
}

// === Barre des tâches ===
const taskbar=document.getElementById('taskbar');
function addTaskIcon(name){
  const icon=document.createElement('div');
  icon.className='task-icon';
  icon.innerText=name[0];
  taskbar.appendChild(icon);
}
addTaskIcon('Nova OS'); // exemple initial

// === Initialisation ===
renderNovaShop();
document.addEventListener('keydown',e=>{if(e.key==='Escape') closeNovaWindow('nova-game-window');});
</script>
</body>
</html>
